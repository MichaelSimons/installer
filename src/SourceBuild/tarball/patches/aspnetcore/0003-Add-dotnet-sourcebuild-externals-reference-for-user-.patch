From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Safia Abdalla <safia@microsoft.com>
Date: Tue, 19 Jul 2022 21:00:40 +0000
Subject: [PATCH] Add dotnet-sourcebuild-externals reference for user-jwts
 dependencies

---
 eng/Dependencies.props                                 | 2 +-
 eng/Version.Details.xml                                | 5 +++++
 eng/Versions.props                                     | 4 +++-
 src/Tools/dotnet-user-jwts/src/dotnet-user-jwts.csproj | 1 +
 4 files changed, 10 insertions(+), 2 deletions(-)

diff --git a/eng/Dependencies.props b/eng/Dependencies.props
index c22eecb7bf..c1b35e4853 100644
--- a/eng/Dependencies.props
+++ b/eng/Dependencies.props
@@ -72,6 +72,7 @@ and are generated based on the last package release.
     <LatestPackageReference Include="System.Diagnostics.DiagnosticSource" />
     <LatestPackageReference Include="System.Diagnostics.EventLog" />
     <LatestPackageReference Include="System.DirectoryServices.Protocols" />
+    <LatestPackageReference Include="System.IdentityModel.Tokens.Jwt" />
     <LatestPackageReference Include="System.IO.Pipelines" />
     <LatestPackageReference Include="System.Net.Http" />
     <LatestPackageReference Include="System.Net.Http.Json" />
@@ -154,7 +155,6 @@ and are generated based on the last package release.
     <LatestPackageReference Include="Microsoft.Web.Administration" />
     <LatestPackageReference Include="Microsoft.Web.Xdt" />
     <LatestPackageReference Include="NETStandard.Library" />
-    <LatestPackageReference Include="System.IdentityModel.Tokens.Jwt" />
     <LatestPackageReference Include="System.Net.Experimental.MsQuic" />
     <LatestPackageReference Include="System.Net.Http.WinHttpHandler" />
     <LatestPackageReference Include="System.ServiceProcess.ServiceController" />
diff --git a/eng/Version.Details.xml b/eng/Version.Details.xml
index bb2938e31f..f26559baad 100644
--- a/eng/Version.Details.xml
+++ b/eng/Version.Details.xml
@@ -181,6 +181,11 @@
       <Uri>https://github.com/dotnet/runtime</Uri>
       <Sha>072eda8d6b2c24ba4c7691a780546a2d6691b1a4</Sha>
     </Dependency>
+    <Dependency Name="Microsoft.SourceBuild.Intermediate.source-build-externals" Version="7.0.0-alpha.1.22369.2">
+      <Uri>https://github.com/dotnet/source-build-externals</Uri>
+      <Sha>3a88d1dbd4557702aa2cb89d5f8bf927bb263a3b</Sha>
+      <SourceBuild RepoName="source-build-externals" ManagedOnly="true" />
+    </Dependency>
     <Dependency Name="System.Configuration.ConfigurationManager" Version="7.0.0-rc.1.22366.5">
       <Uri>https://github.com/dotnet/runtime</Uri>
       <Sha>072eda8d6b2c24ba4c7691a780546a2d6691b1a4</Sha>
diff --git a/eng/Versions.props b/eng/Versions.props
index cae54c5513..e172a9e3d9 100644
--- a/eng/Versions.props
+++ b/eng/Versions.props
@@ -139,6 +139,8 @@
     <!-- Packages from dotnet/arcade -->
     <MicrosoftDotNetBuildTasksInstallersVersion>7.0.0-beta.22367.1</MicrosoftDotNetBuildTasksInstallersVersion>
     <MicrosoftDotNetBuildTasksTemplatingVersion>7.0.0-beta.22367.1</MicrosoftDotNetBuildTasksTemplatingVersion>
+    <!-- Packages from dotnet/source-build-externals -->
+    <MicrosoftSourceBuildIntermediatesourcebuildexternalsVersion>7.0.0-alpha.1.22369.2</MicrosoftSourceBuildIntermediatesourcebuildexternalsVersion>
   </PropertyGroup>
   <!--
 
@@ -222,7 +224,7 @@
     <MicrosoftOwinTestingVersion>3.0.1</MicrosoftOwinTestingVersion>
     <MicrosoftWebAdministrationVersion>11.1.0</MicrosoftWebAdministrationVersion>
     <MicrosoftWebXdtVersion>1.4.0</MicrosoftWebXdtVersion>
-    <SystemIdentityModelTokensJwtVersion>6.15.1</SystemIdentityModelTokensJwtVersion>
+    <SystemIdentityModelTokensJwtVersion>6.21.0</SystemIdentityModelTokensJwtVersion>
     <NuGetPackagingVersion>6.2.0</NuGetPackagingVersion>
     <NuGetVersioningVersion>6.2.0</NuGetVersioningVersion>
     <NuGetFrameworksVersion>6.2.0</NuGetFrameworksVersion>
diff --git a/src/Tools/dotnet-user-jwts/src/dotnet-user-jwts.csproj b/src/Tools/dotnet-user-jwts/src/dotnet-user-jwts.csproj
index 3c9eeae2b0..b718158881 100644
--- a/src/Tools/dotnet-user-jwts/src/dotnet-user-jwts.csproj
+++ b/src/Tools/dotnet-user-jwts/src/dotnet-user-jwts.csproj
@@ -9,6 +9,7 @@
     <PackAsTool>true</PackAsTool>
     <!-- This package is for internal use only. It contains a CLI which is bundled in the .NET Core SDK. -->
     <IsShippingPackage>false</IsShippingPackage>
+    <ExcludeFromSourceBuild>false</ExcludeFromSourceBuild>
   </PropertyGroup>
 
   <ItemGroup>
